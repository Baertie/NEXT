(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){e.exports=a.p+"static/media/topBlack-lighten.cbdaa932.png"},101:function(e,t,a){e.exports=a.p+"static/media/botRed-softLight.bb02e9f5.png"},102:function(e,t,a){e.exports=a.p+"static/media/botBlack-softLight.ff23e384.png"},103:function(e,t,a){e.exports=a.p+"static/media/blackOverlay.54ec1d9f.png"},104:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),o=a(17),s=a.n(o),i=(a(59),a(60),a(4)),c=a(5),l=a.n(c),u=a(6),d=a(9),h=a(11),g=a(10),v=a(24),f=a(12),m=a(7),p=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={posterArray:["http://jannesdegreve.be/next/posters/affiche_1","http://jannesdegreve.be/next/posters/affiche_2","http://jannesdegreve.be/next/posters/affiche_3","http://jannesdegreve.be/next/posters/affiche_4","http://jannesdegreve.be/next/posters/affiche_5","http://jannesdegreve.be/next/posters/affiche_6","http://jannesdegreve.be/next/posters/affiche_7"],posterIndex:0},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),this.props.timeOut)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"tick",value:function(){this.state.posterIndex<this.state.posterArray.length-1?this.setState({posterIndex:this.state.posterIndex+1}):this.setState({posterIndex:0})}},{key:"render",value:function(){return r.a.createElement("img",{src:this.state.posterArray[this.state.posterIndex],alt:"",style:{width:"100%",height:"auto"}})}}]),t}(n.Component),b=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e)))._isMounted=!1,a.detect=function(){var e,t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.videoTag.current,n.next=3,l.a.awrap(m.e.ssdMobilenetv1.loadFromUri("./models"));case 3:t={width:e.width,height:e.height},console.log("displaySize",t),a.timerID=setInterval((function(){var t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==a.state.detected){n.next=6;break}return n.next=3,l.a.awrap(m.a(e));case 3:t=n.sent,console.log(t.length),a._isMounted&&(t.length>0?(a.state.timeSinceDetectedFace>=2e3&&(console.log("3 seconden lang een gezicht"),a.state.detected=!0),a.setState({timeSinceDetectedFace:a.state.timeSinceDetectedFace+200})):a.setState({timeSinceDetectedFace:0}));case 6:case"end":return n.stop()}}))}),400);case 6:case"end":return n.stop()}}))},a.videoTag=r.a.createRef(),a.canvasTag=r.a.createRef(),a.state={video:null,timeSinceDetectedFace:0,detected:!1},a.detect=a.detect.bind(Object(v.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){return e.videoTag.current.srcObject=t}),this.detect()).catch(console.log("failed to get user media"))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.timerID)}},{key:"render",value:function(){var e=this.props.store;return!0===this.state.detected&&e.setDetected(),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{timeOut:3e3}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("video",{style:{position:"absolute",top:"0",left:"0",visibility:"hidden"},id:"videoTag",ref:this.videoTag,width:500,height:500,autoPlay:!0,muted:!0})))))}}]),t}(n.Component),w=Object(i.b)("store")(Object(i.c)(b)),y=Object(i.b)("store")(Object(i.c)((function(e){var t=e.store;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Onboarding welkom"),r.a.createElement("button",{onClick:function(e){console.log("reset"),t.resetEverything()}},"Reset"))}))),E=a(23),C=a.n(E),O=function(){return r.a.createElement("p",null,"Loading...")},j=a(8),x=a(45),k=a.n(x),I=(a(99),a(100),a(101),a(102),a(46)),S=a.n(I),M=a(47),T=a.n(M),R=a(48),D=a.n(R),_=a(49),F=a.n(_),B=(a(103),a(50)),L=a.n(B),A=a(51),U=a.n(A),G=a(52),P=a.n(G),N=a(53),V=a.n(N),W=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e)))._isMounted=!1,a.initSocket=function(){},a.loadModels=function(){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.awrap(m.e.ssdMobilenetv1.loadFromUri("./models"));case 2:return e.next=4,l.a.awrap(m.e.faceLandmark68TinyNet.loadFromUri("./models"));case 4:a.getReferenceData();case 5:case"end":return e.stop()}}))},a.getReferenceData=function(){var e,t,n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:a._isMounted&&(e=a.referenceCanvasTag.current,t=e.getContext("2d"),(n=new Image(480,720)).onload=function(){var r,o;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return m.d(e,n),t.drawImage(n,0,0,e.width,e.height),!0,s.next=5,l.a.awrap(m.b(n).withFaceLandmarks(!0));case 5:r=s.sent,console.log(r),o=r.landmarks.positions,"reference",a.addPointsToState(o,"reference"),m.c.drawFaceLandmarks(e,r),a.setState({_isLoaded:!0});case 12:case"end":return s.stop()}}))},n.src=a.state.referenceImageArray[a.state.currentRound-1]);case 1:case"end":return r.stop()}}))},a.screenShot=function(){var e,t,n,r,o,s;return l.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a._isMounted,e=a.videoTag.current,t=a.canvasTag.current,n=t.getContext("2d"),r={width:e.width,height:e.height},m.d(t,r),n.clearRect(0,0,t.width,t.height),n.drawImage(e,0,0,t.width,t.height),!0,i.next=11,l.a.awrap(m.b(t).withFaceLandmarks(!0));case 11:(o=i.sent)&&(s=o.landmarks.positions,"player",a.addPointsToState(s,"player")),a.addSharpenEffect(e,t,n),a.addVisualEffects(t,n),a.calculateDistance(),a.goToNextRound();case 17:case"end":return i.stop()}}))},a.addSharpenEffect=function(e,t,n){var r=a.greyCanvasTag.current,o=a.blurCanvasTag.current,s=r.getContext("2d"),i=o.getContext("2d");s.drawImage(e,0,0,r.width,r.height),s.globalCompositeOperation="color",s.fillStyle="Gray",s.fillRect(0,0,r.width,r.height),o.width=r.width/4,o.height=r.height/4,i.drawImage(r,0,0,o.width,o.height),k()(o,o.width,o.height,10),i.globalCompositeOperation="difference",i.fillStyle="white",i.fillRect(0,0,o.width,o.height),s.globalCompositeOperation="source-over",s.globalAlpha=.5,s.drawImage(o,0,0,r.width,r.height),s.globalAlpha=1,n.globalAlpha=1,n.drawImage(e,0,0,t.width,t.height),n.globalCompositeOperation="overlay",n.drawImage(r,0,0,t.width,t.height),n.drawImage(r,0,0,t.width,t.height),n.globalCompositeOperation="source-over"},a.addVisualEffects=function(e,t){t.translate(e.width,0),t.scale(-1,1);var a=new Image,n=new Image,r=new Image,o=new Image,s=new Image;a.onload=function(){t.globalCompositeOperation="soft-light",t.drawImage(a,0,0,e.width,e.height)},n.onload=function(){t.globalCompositeOperation="soft-light",t.drawImage(n,0,0,e.width,e.height)},r.onload=function(){t.globalCompositeOperation="lighten",t.drawImage(r,0,0,e.width,e.height)},o.onload=function(){t.globalCompositeOperation="lighten",t.drawImage(a,0,0,e.width,e.height)},s.onload=function(){t.globalCompositeOperation="source-over",t.drawImage(s,0,0,e.width,e.height)},a.src=F.a,n.src=D.a,r.src=T.a,o.src=S.a,s.src=L.a,console.log(o),console.log(s)},a.addPointsToState=function(e,t){for(var n=[],r=[],o=[],s=[],i=[],c=[],l=[],u=[],d=[],h=0;h<17;h++)n.push(e[h]);for(var g=17;g<22;g++)r.push(e[g]);for(var v=22;v<27;v++)o.push(e[v]);for(var f=27;f<31;f++)s.push(e[f]);for(var m=31;m<36;m++)i.push(e[m]);for(var p=36;p<42;p++)c.push(e[p]);for(var b=42;b<48;b++)l.push(e[b]);for(var w=48;w<60;w++)u.push(e[w]);for(var y=60;y<67;y++)d.push(e[y]);"player"===t&&a.setState((function(t){t.curves[1]=e,t.faceCurves[1]=n,t.lEyebrowCurves[1]=r,t.rEyebrowCurves[1]=o,t.noseBridgeCurves[1]=s,t.noseBotCurves[1]=i,t.lEyeCurves[1]=c,t.rEyeCurves[1]=l,t.oMouthCurves[1]=u,t.iMouthCurves[1]=d})),"reference"===t&&a.setState((function(t){t.curves[0]=e,t.faceCurves[0]=n,t.lEyebrowCurves[0]=r,t.rEyebrowCurves[0]=o,t.noseBridgeCurves[0]=s,t.noseBotCurves[0]=i,t.lEyeCurves[0]=c,t.rEyeCurves[0]=l,t.oMouthCurves[0]=u,t.iMouthCurves[0]=d}))},a.calculateDistance=function(){if(a.state.curves[0]&&a.state.curves[1]){var e=Object(j.a)(a.state.faceCurves[0],a.state.faceCurves[1]);console.log("similarity face:",e);var t=Object(j.a)(a.state.lEyebrowCurves[0],a.state.lEyebrowCurves[1]);console.log("similarity LEyeBrow:",t);var n=Object(j.a)(a.state.rEyebrowCurves[0],a.state.rEyebrowCurves[1]);console.log("similarity REyeBrow:",n);var r=Object(j.a)(a.state.noseBridgeCurves[0],a.state.noseBridgeCurves[1]);console.log("similarity NoseBridge:",r);var o=Object(j.a)(a.state.noseBotCurves[0],a.state.noseBotCurves[1]);console.log("similarity NoseBot:",o);var s=Object(j.a)(a.state.lEyeCurves[0],a.state.lEyeCurves[1]);console.log("similarity LEye:",s);var i=Object(j.a)(a.state.rEyeCurves[0],a.state.rEyeCurves[1]);console.log("similarity REye:",i);var c=Object(j.a)(a.state.oMouthCurves[0],a.state.oMouthCurves[1]);console.log("similarity OMouth:",c);var l=Object(j.a)(a.state.iMouthCurves[0],a.state.iMouthCurves[1]);console.log("similarity i mouth:",l);var u=(e+t+n+c+l)/5*100;console.log("Average: averageSimilarity",u),a.setState({similarity:u});var d=Object(j.a)(a.state.curves[0],a.state.curves[1]);console.log("similarity whole thing:",d)}else console.log("geen curves in state momenteel")},a.goToNextRound=function(){a.setState((function(e){return{currentRound:e.currentRound+1}})),a.getReferenceData()},a.videoTag=r.a.createRef(),a.canvasTag=r.a.createRef(),a.referenceImageTag=r.a.createRef(),a.referenceCanvasTag=r.a.createRef(),a.greyCanvasTag=r.a.createRef(),a.blurCanvasTag=r.a.createRef(),a.state={video:null,constraints:{audio:!1,video:{width:480,height:720}},faceCurves:[],lEyebrowCurves:[],rEyebrowCurves:[],noseBridgeCurves:[],noseBotCurves:[],lEyeCurves:[],rEyeCurves:[],oMouthCurves:[],iMouthCurves:[],curves:[],similarity:null,currentRound:1,maxRounds:3,referenceImageArray:[],_isLoaded:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,console.log(this.state.constraints),console.log(navigator.mediaDevices),navigator.mediaDevices.getUserMedia(this.state.constraints).then((function(t){return e.videoTag.current.srcObject=t}),this.loadModels()).catch(console.log),this.setState((function(e){e.referenceImageArray.push(U.a),e.referenceImageArray.push(P.a),e.referenceImageArray.push(V.a)}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props.store;this.state.currentRound>3&&t.setGameEnded();return r.a.createElement(r.a.Fragment,null,this.state._isLoaded?null:r.a.createElement(O,null),r.a.createElement("div",{style:{display:this.state._isLoaded?"block":"none"}},r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){console.log("generate"),e.screenShot()}},"Play"),r.a.createElement("p",null,"similarity: ",this.state.similarity?this.state.similarity:"0"),r.a.createElement("p",null,"current round: ",this.state.currentRound)),r.a.createElement("div",null,r.a.createElement("canvas",{ref:this.referenceCanvasTag,width:480,height:720}),r.a.createElement("video",{style:{top:"0",left:"0",transform:"scaleX(-1)"},id:"videoTag",ref:this.videoTag,width:this.state.constraints.video.width,height:this.state.constraints.video.height,autoPlay:!0,muted:!0}),r.a.createElement("canvas",{style:{transform:"scaleX(-1)"},id:"myCanvas",ref:this.canvasTag,width:this.state.constraints.video.width,height:this.state.constraints.video.height}),r.a.createElement("div",null,r.a.createElement("canvas",{style:{transform:"scaleX(-1)",display:"none"},id:"greyCanvas",ref:this.greyCanvasTag,width:this.state.constraints.video.width,height:this.state.constraints.video.height}),r.a.createElement("canvas",{style:{transform:"scaleX(-1)",display:"none"},id:"blurCanvas",ref:this.blurCanvasTag,width:this.state.constraints.video.width,height:this.state.constraints.video.height})))))}}]),t}(n.Component),X=Object(i.b)("store")(Object(i.c)(W)),z=(n.Component,function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).ownVideoFeed=r.a.createRef(),a.state={video:null,constraints:{audio:!1,video:{width:480,height:720}}},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia(this.state.constraints).then((function(t){return e.ownVideoFeed.current.srcObject=t})).catch(console.log("failed to get user media"))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Socket test"),r.a.createElement("video",{id:"ownVideoFeed",ref:this.ownVideoFeed,width:200,height:200,autoPlay:!0,muted:!0}))}}]),t}(n.Component)),J=Object(i.b)("store")(Object(i.c)((function(e){switch(e.store.flowStatus){case"detectedFalse":return r.a.createElement(w,null);case"detectedTrue":return r.a.createElement(y,null);case"onboardingEnded":return r.a.createElement(X,null);case"gameEnded":return r.a.createElement(y,null);case"Socket":return r.a.createElement(z,null);default:return r.a.createElement(w,null)}}))),$=Object(i.b)("store")(Object(i.c)((function(e){var t=e.store;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){console.log("reset"),t.resetEverything()}},"Poster carousel"),r.a.createElement("button",{onClick:function(e){console.log("onboarding"),t.setDetected()}},"Onboarding"),r.a.createElement("button",{onClick:function(e){console.log("start game"),t.startGame()}},"Start Game"))})));var q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement($,null),r.a.createElement(J,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var H=a(3);Object(H.f)({enforceActions:"observed"});var K=function e(){var t=this;Object(u.a)(this,e),this.flowStatus="Socket",this.setDetected=function(){t.flowStatus="detectedTrue"},this.startGame=function(){t.flowStatus="onboardingEnded"},this.resetEverything=function(){t.flowStatus="detectedFalse"},this.setGameEnded=function(){t.flowStatus="gameEnded"}};Object(H.h)(K,{detected:H.m,setDetected:H.d,resetEverything:H.d,flowStatus:H.m,startGame:H.d,setGameEnded:H.d});var Q=new K;s.a.render(r.a.createElement(i.a,{store:Q},r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},46:function(e,t,a){e.exports=a.p+"static/media/topMag-lighten.474179bf.png"},47:function(e,t,a){e.exports=a.p+"static/media/topBlue-lighten.aaa2da5d.png"},48:function(e,t,a){e.exports=a.p+"static/media/botMag-softLight.45f1a164.png"},49:function(e,t,a){e.exports=a.p+"static/media/botBlue-softLight.db9be1e2.png"},50:function(e,t,a){e.exports=a.p+"static/media/whiteOverlay.a94ca8a5.png"},51:function(e,t,a){e.exports=a.p+"static/media/reference_1.ad681ba9.jpg"},52:function(e,t,a){e.exports=a.p+"static/media/reference_2.9526096b.jpg"},53:function(e,t,a){e.exports=a.p+"static/media/reference_3.0891363a.jpg"},54:function(e,t,a){e.exports=a(104)},59:function(e,t,a){},60:function(e,t,a){},67:function(e,t){},68:function(e,t){},69:function(e,t){},96:function(e,t){},99:function(e,t,a){e.exports=a.p+"static/media/topRed-lighten.1f3f44aa.png"}},[[54,1,2]]]);
//# sourceMappingURL=main.6a9c4b94.chunk.js.map